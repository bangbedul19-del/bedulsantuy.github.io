<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Android Dialog Timing Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  button { padding: 14px 20px; font-size: 16px; }
  .note { color:#555; margin-top:10px; }
</style>
</head>
<body>

<h2>Android: Permission / Context / Download</h2>
<p>Uji antrian dialog & konteks visual di Android.</p>

<button id="run">Run Test</button>
<p class="note">
Amati: dialog muncul di tab mana, dan teks "dari â€¦" pada dialog download.
</p>

<script>
document.getElementById('run').onclick = () => {

  // 1) Permission kamera (via user gesture)
  navigator.mediaDevices.getUserMedia({ video: true })
    .catch(() => { /* lanjut uji meski ditolak */ });

  // 2) Context switch cepat: buka tab baru
  window.open('https://example.com', '_blank');

  // 3) Delay lalu trigger download
  setTimeout(() => {
    const a = document.createElement('a');
    a.href =
      'data:text/plain,' +
      'ANDROID_SOURCE_' +
      'example.com_' +
      'Y'.repeat(25000) +
      '_END';
    a.download = 'android-test.txt';
    document.body.appendChild(a);
    a.click();
    a.remove();
  }, 500); // variasikan: 100 / 300 / 500 / 900 ms
};
</script>

</body>
</html>
